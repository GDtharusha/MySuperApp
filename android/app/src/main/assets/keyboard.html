<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no,viewport-fit=cover">
    <meta name="theme-color" content="#0f0f1a">
    <title>Fast Keyboard</title>
    <style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CSS VARIABLES - à¶¸à·™à¶­à¶±à·’à¶±à·Š colors/sizes à·€à·™à¶±à·ƒà·Š à¶šà¶»à¶±à·Šà¶± à¶´à·”à·…à·”à·€à¶±à·Š
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
    /* Colors - à¶”à¶¶à¶§ à¶šà·à¶¸à¶­à·’ colors à¶¯à·à¶±à·Šà¶± */
    --bg-primary: #0f0f1a;
    --bg-secondary: #1a1a2e;
    --key-bg: linear-gradient(180deg, #3d3d5c 0%, #2a2a45 100%);
    --key-bg-pressed: linear-gradient(180deg, #5a5a8c 0%, #4a4a7a 100%);
    --key-special-bg: linear-gradient(180deg, #252540 0%, #1a1a30 100%);
    --key-enter-bg: linear-gradient(180deg, #2563eb 0%, #1d4ed8 100%);
    --key-text: #ffffff;
    --key-text-special: #9090b0;
    --key-shadow: 0 2px 0 rgba(0,0,0,0.3), 0 3px 6px rgba(0,0,0,0.2);
    
    /* Sizes - à¶”à¶¶à¶§ à¶šà·à¶¸à¶­à·’ sizes à¶¯à·à¶±à·Šà¶± */
    --key-radius: 8px;
    --key-font-size: 22px;
    --key-special-font-size: 13px;
    --row-gap: 8px;
    --key-gap: 5px;
    --padding-horizontal: 4px;
    --padding-top: 8px;
    --padding-bottom: 6px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESET & BASE STYLES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    user-select: none;
}

html, body {
    width: 100%;
    height: 100%;
    overflow: hidden;
    touch-action: none;
    overscroll-behavior: none;
    background: var(--bg-primary);
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    -webkit-font-smoothing: antialiased;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   KEYBOARD CONTAINER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#keyboard {
    display: flex;
    flex-direction: column;
    width: 100%;
    height: 100%;
    padding: var(--padding-top) var(--padding-horizontal) var(--padding-bottom);
    gap: var(--row-gap);
    background: var(--bg-secondary);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   KEYBOARD ROWS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.row {
    display: flex;
    justify-content: center;
    gap: var(--key-gap);
    flex: 1;
    min-height: 0;
}

/* Row 2 padding (A-L row) */
.row:nth-child(2) {
    padding: 0 4%;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   KEY BUTTONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.key {
    display: flex;
    align-items: center;
    justify-content: center;
    flex: 1;
    min-width: 28px;
    max-width: 42px;
    background: var(--key-bg);
    border: none;
    border-radius: var(--key-radius);
    box-shadow: var(--key-shadow);
    color: var(--key-text);
    font-size: var(--key-font-size);
    font-weight: 500;
    cursor: pointer;
    transition: transform 0.06s ease, background 0.06s ease;
    will-change: transform;
    position: relative;
    overflow: hidden;
}

/* Active/Pressed state */
.key.active {
    background: var(--key-bg-pressed);
    transform: scale(0.92);
}

/* Special keys (shift, delete, 123, etc.) */
.key.special {
    background: var(--key-special-bg);
    color: var(--key-text-special);
    font-size: var(--key-special-font-size);
    font-weight: 600;
    max-width: 56px;
    flex: 1.5;
}

/* Enter key */
.key.enter {
    background: var(--key-enter-bg);
    color: #fff;
    max-width: 56px;
    flex: 1.5;
}

/* Space bar */
.key.space {
    max-width: none;
    flex: 5;
    font-size: 12px;
    letter-spacing: 2px;
    color: var(--key-text-special);
}

/* Shift active state */
.key.shift.shifted {
    background: linear-gradient(180deg, #3b82f6 0%, #2563eb 100%);
    color: #fff;
}

/* Caps lock state */
.key.shift.caps {
    background: linear-gradient(180deg, #10b981 0%, #059669 100%);
    color: #fff;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   KEY ICONS (SVG)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.key svg {
    width: 22px;
    height: 22px;
    fill: currentColor;
    pointer-events: none;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   KEY POPUP PREVIEW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#popup {
    position: fixed;
    display: none;
    align-items: center;
    justify-content: center;
    width: 56px;
    height: 72px;
    background: linear-gradient(180deg, #5a5a8c 0%, #4a4a7a 100%);
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.4);
    color: #fff;
    font-size: 38px;
    font-weight: 600;
    pointer-events: none;
    z-index: 1000;
    transform: translateX(-50%);
}

#popup.show {
    display: flex;
    animation: popIn 0.1s ease-out;
}

@keyframes popIn {
    from { opacity: 0; transform: translateX(-50%) scale(0.6); }
    to { opacity: 1; transform: translateX(-50%) scale(1); }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOOLBAR (Top row - optional features)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#toolbar {
    display: none; /* 'flex' à¶šà¶»à¶±à·Šà¶± toolbar à¶´à·™à¶±à·Šà·€à¶±à·Šà¶± */
    height: 44px;
    padding: 4px 8px;
    gap: 8px;
    background: var(--bg-primary);
    border-bottom: 1px solid rgba(255,255,255,0.05);
}

.toolbar-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 8px 16px;
    background: rgba(255,255,255,0.1);
    border: none;
    border-radius: 20px;
    color: #fff;
    font-size: 13px;
    cursor: pointer;
}

.toolbar-btn:active {
    background: rgba(255,255,255,0.2);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   VOICE INPUT OVERLAY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#voiceOverlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: rgba(15, 15, 26, 0.95);
    z-index: 2000;
}

#voiceOverlay.show {
    display: flex;
}

.voice-icon {
    width: 80px;
    height: 80px;
    background: linear-gradient(180deg, #ef4444 0%, #dc2626 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 24px;
    animation: pulse 1.5s infinite;
}

.voice-icon svg {
    width: 40px;
    height: 40px;
    fill: #fff;
}

@keyframes pulse {
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.1); opacity: 0.8; }
}

.voice-text {
    color: #fff;
    font-size: 18px;
    margin-bottom: 8px;
}

.voice-partial {
    color: rgba(255,255,255,0.6);
    font-size: 14px;
    max-width: 80%;
    text-align: center;
}

.voice-cancel {
    margin-top: 32px;
    padding: 12px 32px;
    background: rgba(255,255,255,0.1);
    border: none;
    border-radius: 24px;
    color: #fff;
    font-size: 14px;
    cursor: pointer;
}
    </style>
</head>
<body>
    <!-- Toolbar (Optional - uncomment to use) -->
    <div id="toolbar">
        <button class="toolbar-btn" onclick="Bridge.startVoice()">ğŸ¤ Voice</button>
        <button class="toolbar-btn" onclick="Bridge.paste()">ğŸ“‹ Paste</button>
    </div>
    
    <!-- Main Keyboard -->
    <div id="keyboard"></div>
    
    <!-- Key Popup Preview -->
    <div id="popup"></div>
    
    <!-- Voice Input Overlay -->
    <div id="voiceOverlay">
        <div class="voice-icon">
            <svg viewBox="0 0 24 24"><path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm-1-9c0-.55.45-1 1-1s1 .45 1 1v6c0 .55-.45 1-1 1s-1-.45-1-1V5zm6 6c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/></svg>
        </div>
        <div class="voice-text">Listening...</div>
        <div class="voice-partial" id="voicePartial"></div>
        <button class="voice-cancel" onclick="Bridge.stopVoice()">Cancel</button>
    </div>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CONFIGURATION - à¶¸à·™à¶­à¶±à·’à¶±à·Š settings à·€à·™à¶±à·ƒà·Š à¶šà¶»à¶±à·Šà¶±
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const CONFIG = {
    // Haptic feedback
    vibrateOnPress: true,
    vibrateDuration: 3,
    
    // Sound
    soundOnPress: false,
    
    // Popup
    showPopup: true,
    
    // Long press
    longPressDelay: 400,
    repeatInterval: 50
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   KEYBOARD LAYOUTS - à¶”à¶¶à¶§ à¶šà·à¶¸à¶­à·’ layouts add à¶šà¶»à¶±à·Šà¶±
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const LAYOUTS = {
    // English QWERTY
    letters: [
        ['q', 'w', 'e', 'r', 't', 'y', 'u', 'i', 'o', 'p'],
        ['a', 's', 'd', 'f', 'g', 'h', 'j', 'k', 'l'],
        ['SHIFT', 'z', 'x', 'c', 'v', 'b', 'n', 'm', 'BACKSPACE'],
        ['NUMBERS', ',', 'SPACE', '.', 'ENTER']
    ],
    
    // Numbers & Symbols
    numbers: [
        ['1', '2', '3', '4', '5', '6', '7', '8', '9', '0'],
        ['@', '#', '$', '%', '&', '-', '+', '(', ')'],
        ['SYMBOLS', '*', '"', "'", ':', ';', '!', '?', 'BACKSPACE'],
        ['LETTERS', ',', 'SPACE', '.', 'ENTER']
    ],
    
    // More Symbols
    symbols: [
        ['~', '`', '|', 'â€¢', 'âˆš', 'Ï€', 'Ã·', 'Ã—', 'Â¶', 'âˆ†'],
        ['Â£', 'â‚¬', 'Â¥', '^', 'Â°', '=', '{', '}', '\\'],
        ['NUMBERS', 'Â©', 'Â®', 'â„¢', 'âœ“', '[', ']', '<', 'BACKSPACE'],
        ['LETTERS', ',', 'SPACE', '.', 'ENTER']
    ]
    
    // à¶”à¶¶à¶§ Sinhala layout à¶‘à¶šà¶šà·Š add à¶šà¶»à¶±à·Šà¶± à¶´à·”à·…à·”à·€à¶±à·Š:
    // sinhala: [
    //     ['à¶š', 'à¶›', 'à¶œ', 'à¶', ...],
    //     ...
    // ]
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ICONS (SVG)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const ICONS = {
    SHIFT: '<svg viewBox="0 0 24 24"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>',
    BACKSPACE: '<svg viewBox="0 0 24 24"><path d="M22 3H7c-.69 0-1.23.35-1.59.88L0 12l5.41 8.11c.36.53.9.89 1.59.89h15c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-3 12.59L17.59 17 14 13.41 10.41 17 9 15.59 12.59 12 9 8.41 10.41 7 14 10.59 17.59 7 19 8.41 15.41 12 19 15.59z"/></svg>',
    ENTER: '<svg viewBox="0 0 24 24"><path d="M19 7v4H5.83l3.58-3.59L8 6l-6 6 6 6 1.41-1.41L5.83 13H21V7z"/></svg>',
    VOICE: '<svg viewBox="0 0 24 24"><path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm-1-9c0-.55.45-1 1-1s1 .45 1 1v6c0 .55-.45 1-1 1s-1-.45-1-1V5zm6 6c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/></svg>'
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STATE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const State = {
    layout: 'letters',
    shift: false,
    caps: false,
    activeKey: null,
    holdTimer: null,
    repeatTimer: null
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BRIDGE - Android à·ƒà¶¸à¶Ÿ communicate à¶šà¶»à¶±à·Šà¶±
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const Bridge = {
    // Check if running on Android
    isAndroid: typeof AndroidBridge !== 'undefined',
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // TEXT INPUT
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    type: function(text) {
        if (this.isAndroid) {
            AndroidBridge.commitText(text);
        } else {
            console.log('ğŸ“ Type:', text);
        }
    },
    
    delete: function(count) {
        count = count || 1;
        if (this.isAndroid) {
            AndroidBridge.deleteText(count);
        } else {
            console.log('âŒ« Delete:', count);
        }
    },
    
    deleteWord: function() {
        if (this.isAndroid) {
            AndroidBridge.deleteWord();
        } else {
            console.log('âŒ« Delete word');
        }
    },
    
    enter: function() {
        if (this.isAndroid) {
            AndroidBridge.performEditorAction();
        } else {
            console.log('â†µ Enter');
        }
    },
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // CLIPBOARD
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    paste: function() {
        if (this.isAndroid) {
            AndroidBridge.pasteFromClipboard();
        } else {
            console.log('ğŸ“‹ Paste');
        }
    },
    
    copy: function() {
        if (this.isAndroid) {
            AndroidBridge.copy();
        } else {
            console.log('ğŸ“‹ Copy');
        }
    },
    
    cut: function() {
        if (this.isAndroid) {
            AndroidBridge.cut();
        } else {
            console.log('âœ‚ï¸ Cut');
        }
    },
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // FEEDBACK
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    vibrate: function(ms) {
        ms = ms || CONFIG.vibrateDuration;
        if (this.isAndroid && CONFIG.vibrateOnPress) {
            AndroidBridge.vibrate(ms);
        } else if (navigator.vibrate) {
            navigator.vibrate(ms);
        }
    },
    
    playSound: function() {
        if (this.isAndroid && CONFIG.soundOnPress) {
            AndroidBridge.playKeySound();
        }
    },
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // VOICE INPUT
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    startVoice: function() {
        if (this.isAndroid) {
            if (AndroidBridge.isVoiceInputAvailable()) {
                AndroidBridge.startVoiceInput();
            } else {
                AndroidBridge.showToast('Voice input not available');
            }
        } else {
            console.log('ğŸ¤ Voice start');
            document.getElementById('voiceOverlay').classList.add('show');
        }
    },
    
    stopVoice: function() {
        if (this.isAndroid) {
            AndroidBridge.stopVoiceInput();
        }
        document.getElementById('voiceOverlay').classList.remove('show');
    },
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // KEYBOARD CONTROL
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    hide: function() {
        if (this.isAndroid) {
            AndroidBridge.hideKeyboard();
        } else {
            console.log('âŒ¨ï¸ Hide keyboard');
        }
    },
    
    switchKeyboard: function() {
        if (this.isAndroid) {
            AndroidBridge.switchKeyboard();
        } else {
            console.log('ğŸ”„ Switch keyboard');
        }
    },
    
    setHeight: function(dp) {
        if (this.isAndroid) {
            AndroidBridge.setKeyboardHeight(dp);
        }
    },
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // UTILITY
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    log: function(msg) {
        if (this.isAndroid) {
            AndroidBridge.log(msg);
        }
        console.log('[KB]', msg);
    }
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RENDERING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function render() {
    const keyboard = document.getElementById('keyboard');
    const layout = LAYOUTS[State.layout];
    
    let html = '';
    
    layout.forEach(row => {
        html += '<div class="row">';
        row.forEach(key => {
            html += createKeyHtml(key);
        });
        html += '</div>';
    });
    
    keyboard.innerHTML = html;
    bindEvents();
}

function createKeyHtml(key) {
    let classes = ['key'];
    let content = '';
    let dataKey = key;
    
    switch(key) {
        case 'SHIFT':
            classes.push('special', 'shift');
            if (State.caps) classes.push('caps');
            else if (State.shift) classes.push('shifted');
            content = ICONS.SHIFT;
            break;
            
        case 'BACKSPACE':
            classes.push('special');
            content = ICONS.BACKSPACE;
            break;
            
        case 'ENTER':
            classes.push('special', 'enter');
            content = ICONS.ENTER;
            break;
            
        case 'SPACE':
            classes.push('space');
            content = 'space';
            break;
            
        case 'NUMBERS':
            classes.push('special');
            content = '123';
            break;
            
        case 'SYMBOLS':
            classes.push('special');
            content = '#+=';
            break;
            
        case 'LETTERS':
            classes.push('special');
            content = 'ABC';
            break;
            
        default:
            // Regular character
            content = (State.shift || State.caps) && /^[a-z]$/.test(key) 
                ? key.toUpperCase() 
                : key;
    }
    
    return `<div class="${classes.join(' ')}" data-key="${dataKey}">${content}</div>`;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   EVENT HANDLING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function bindEvents() {
    const keyboard = document.getElementById('keyboard');
    
    // Touch events
    keyboard.addEventListener('touchstart', onTouchStart, { passive: false });
    keyboard.addEventListener('touchend', onTouchEnd, { passive: false });
    keyboard.addEventListener('touchcancel', onTouchEnd, { passive: false });
    
    // Mouse events (for testing)
    keyboard.addEventListener('mousedown', onTouchStart, { passive: false });
    keyboard.addEventListener('mouseup', onTouchEnd, { passive: false });
    keyboard.addEventListener('mouseleave', onTouchEnd, { passive: false });
    
    // Prevent context menu
    keyboard.addEventListener('contextmenu', e => e.preventDefault());
}

function onTouchStart(e) {
    e.preventDefault();
    
    const touch = e.touches ? e.touches[0] : e;
    const target = document.elementFromPoint(touch.clientX, touch.clientY);
    const keyEl = target?.closest('.key');
    
    if (!keyEl) return;
    
    const key = keyEl.dataset.key;
    if (!key) return;
    
    // Visual feedback
    keyEl.classList.add('active');
    State.activeKey = keyEl;
    
    // Haptic & sound feedback
    Bridge.vibrate();
    Bridge.playSound();
    
    // Show popup
    if (CONFIG.showPopup && key.length === 1) {
        showPopup(keyEl, (State.shift || State.caps) && /^[a-z]$/.test(key) 
            ? key.toUpperCase() : key);
    }
    
    // Handle key
    handleKey(key);
    
    // Long press for backspace
    if (key === 'BACKSPACE') {
        State.holdTimer = setTimeout(() => {
            State.repeatTimer = setInterval(() => {
                Bridge.delete(1);
                Bridge.vibrate(2);
            }, CONFIG.repeatInterval);
        }, CONFIG.longPressDelay);
    }
}

function onTouchEnd(e) {
    e.preventDefault();
    
    // Clear active state
    if (State.activeKey) {
        State.activeKey.classList.remove('active');
        State.activeKey = null;
    }
    
    // Clear timers
    clearTimeout(State.holdTimer);
    clearInterval(State.repeatTimer);
    State.holdTimer = null;
    State.repeatTimer = null;
    
    // Hide popup
    hidePopup();
}

function handleKey(key) {
    switch(key) {
        case 'SHIFT':
            handleShift();
            break;
            
        case 'BACKSPACE':
            Bridge.delete(1);
            break;
            
        case 'ENTER':
            Bridge.enter();
            break;
            
        case 'SPACE':
            Bridge.type(' ');
            autoUnshift();
            break;
            
        case 'NUMBERS':
            State.layout = 'numbers';
            render();
            break;
            
        case 'SYMBOLS':
            State.layout = 'symbols';
            render();
            break;
            
        case 'LETTERS':
            State.layout = 'letters';
            render();
            break;
            
        default:
            // Regular character
            let char = key;
            if ((State.shift || State.caps) && /^[a-z]$/.test(key)) {
                char = key.toUpperCase();
            }
            Bridge.type(char);
            autoUnshift();
    }
}

function handleShift() {
    if (State.caps) {
        // Turn off caps lock
        State.caps = false;
        State.shift = false;
    } else if (State.shift) {
        // Double tap = caps lock
        State.caps = true;
    } else {
        // Single tap = shift
        State.shift = true;
    }
    render();
}

function autoUnshift() {
    if (State.shift && !State.caps) {
        State.shift = false;
        render();
    }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   POPUP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function showPopup(keyEl, char) {
    const popup = document.getElementById('popup');
    const rect = keyEl.getBoundingClientRect();
    
    popup.textContent = char;
    popup.style.left = (rect.left + rect.width / 2) + 'px';
    popup.style.top = (rect.top - 20) + 'px';
    popup.classList.add('show');
}

function hidePopup() {
    document.getElementById('popup').classList.remove('show');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ANDROID CALLBACKS - Android à·ƒà·’à¶§ call à·€à·™à¶± functions
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

// Keyboard ready
function onBridgeReady() {
    Bridge.log('Bridge ready!');
}

// Input field info à¶½à·à¶¶à·™à¶±à·€à·
function onInputStart(info) {
    Bridge.log('Input start: ' + JSON.stringify(info));
    
    // Auto switch to numbers for number inputs
    if (info.inputType === 2 || info.inputType === 3) {
        State.layout = 'numbers';
        render();
    } else if (State.layout !== 'letters') {
        State.layout = 'letters';
        render();
    }
}

function onInputEnd() {
    Bridge.log('Input end');
}

// Orientation change
function onOrientationChange(orientation) {
    Bridge.log('Orientation: ' + orientation);
}

// Voice callbacks
function onVoiceStart() {
    document.getElementById('voiceOverlay').classList.add('show');
    document.getElementById('voicePartial').textContent = '';
}

function onVoiceEnd() {
    document.getElementById('voiceOverlay').classList.remove('show');
}

function onVoiceResult(text) {
    document.getElementById('voiceOverlay').classList.remove('show');
    Bridge.log('Voice result: ' + text);
}

function onVoicePartial(text) {
    document.getElementById('voicePartial').textContent = text;
}

function onVoiceError(error) {
    document.getElementById('voiceOverlay').classList.remove('show');
    if (Bridge.isAndroid) {
        AndroidBridge.showToast(error);
    }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INITIALIZATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
document.addEventListener('DOMContentLoaded', () => {
    Bridge.log('Keyboard initializing...');
    render();
    Bridge.log('Keyboard ready!');
});
</script>
</body>
</html>